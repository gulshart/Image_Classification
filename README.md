# Классификация изображений для сервиса DonorSearch.


## Описание
Сервис по поиску доноров DonorSearch обрабатывает огромное количество справок, в том числе и формата 405. Справки загружаются польщователями в качестве картинки или в pdf формате. Существующая версия сервиса требует вертикальной ориентации справки, однако, с точки зрения удобства пользователя хотелось бы обрабатывать справки независимо от их ориентации.


### Цель

Целью данного проекта является разработать модель определения ориентации справки и автоматического поворота ее в нормальное положение перед запуском сервиса OCR (optical character recognition).

### Заказчик

Компания DonorSearch занимается поиском доноров по всей стране.


### **Инструкции по использованию:**
Для того, чтобы корректно работать с данным проектом, необходимо:
```
- Для классификации изображений: выгрузить файлы data_preparation.ipynb, final.ipynb, own_functions.py, requirements.txt

- Для запуска приложения через Docker:выгрузить requirements.txt, app.py. Dockerfile.

```

### Исходные данные

 Датасет из 173 справок различного формата, включая справку 405 с таблицей.

### Метрика и условия: 
- Метрика оценки модели для многоклассовой классификации– Accuracy.
- Построены ROC-кривые и матрицы ошибок для наилучшей из моделей




## Выбор модели

В проекте использовалось:
- предобученная модель ResNet50
- VGG11

**Результат:**

Создание микросервиса для последующей интеграции в продукт заказчика. 

## Структура репозитория:

| #    | Наименование файла                | Описание   |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1.   | [README.md](https://github.com/IliaShi/donor_search/blob/main/README.md) | Представлена основная информация по проекту и его результатах   |
| 2.   | [final.ipynb](https://github.com/IliaShi/donor_search/blob/main/final.ipynb) | Тетрадка с основным решением |
| 3.   | [data_preparation.ipynb](https://github.com/IliaShi/donor_search/blob/main/data_preparation.ipynb) | Тетрадка для подготовки датасета из исходных фотографий   |
| 4.   | [experiments.ipynb](https://github.com/IliaShi/donor_search/blob/main/experiments.ipynb) | Тетрадка с экспериментами и поиском решения   |
| 5.   | [own_functions.py](https://github.com/IliaShi/donor_search/blob/main/own_functions.py) | Собственные функции для файла final  |
| 6.   | [requirements.txt](https://github.com/IliaShi/donor_search/blob/main/requirements.txt) | Список всех библиотек и их версии, необходимых для установки в виртуальной среде для запуска кода проекта   |
| 7.   | [Dockerfile](https://github.com/IliaShi/donor_search/blob/main/app/Dockerfile) | Докер-файл для запуска приложения
| 8.   | [requirements.txt](https://github.com/IliaShi/donor_search/blob/main/app/requirements.txt) | Список всех библиотек и их версии, необходимых для установки в виртуальной среде для запуска приложения в Докере |
| 9.   | [app.py](https://github.com/IliaShi/donor_search/blob/main/app/scr/app.py) |Скрипт для запуска приложения |
|10.   | [model.py](https://github.com/IliaShi/donor_search/blob/main/app/scr/app.py) |Запуск сохраненной модели лучшего решения |


## Итоги

* **Основные выводы:**  
В ходе проекта был подготовлен датасет - исходные изображения были аугументированы и поворотом на 90, 180 и 270 градусов были созданы 4 класса.  Для классификации на классы были выбраны модели ResNet50, VGG11 и обучены на данных. В качестве метрики выбрана Accuracy и с помощью VGG11 был достигнут показатель 1.0, ResNet - 0.98. Так как инференс моделей сопоставим, наилучшей была выбрана модель VGG11 и использована для запуска приложения в Docker.

* **Проект может быть развит в следующих направлениях:**
  
   * **Обучение моделей на датасете большего размера:**  Обучение моделей на большем датасете может улучшить их качество и обобщающую способность.
   * **Обучение моделей на датасете без скрытия личных данных:** Так как на данных изображениях личные данные были скрыты, а на реальных справках данные остаются, было предположено, что это влияет на качество модели.



## Cтатус: 
Завершён.

## Стэк:
- PyTorch - для работы с Deep Learning моделями
- Numpy для математических операций
- matplotlib и seaborn - для визуализации данных.
- Pillow, Open-CV для работы с изображениями
- Scikit-learn для расчета метрик и обработки результатов
- FastApi для создания интерфейса модели
- Docker для создания микросервиса

## Команда проекта
- [Илья Широких](https://github.com/IliaShi)
- [Гульшат Зарипова](https://github.com/gulshart)

